<div _ngcontent-ng-c3055955716="" class="solutions-tab" style="padding: 24px;"><h1 _ngcontent-ng-c3055955716="" style="font-size: 26px; margin-top: 24px; margin-bottom: 20px;">Prerequisites</h1><app-prereq-cards _ngcontent-ng-c3055955716="" _nghost-ng-c4097940591=""><div _ngcontent-ng-c4097940591="" class="lesson-container flex-container-row"><a _ngcontent-ng-c4097940591="" class="card menu-card my-card" href="/courses/dsa-for-beginners/4"><div _ngcontent-ng-c4097940591="" class="flex-container-row" style="justify-content: space-between; align-items: start;"><span _ngcontent-ng-c4097940591="" style="margin-right: 10px; font-weight: 600;">Stacks</span><span _ngcontent-ng-c4097940591=""><label _ngcontent-ng-c4097940591="" class="b-checkbox checkbox" style="margin: 0px;"><input _ngcontent-ng-c4097940591="" type="checkbox"/><span _ngcontent-ng-c4097940591="" class="check is-success" style="height: 0.9em; width: 0.9em;"></span></label></span></div><span _ngcontent-ng-c4097940591="" class="course-name">Data Structures &amp; Algorithms for Beginners</span></a><!-- --></div></app-prereq-cards><!-- --><!-- --><app-article _ngcontent-ng-c3055955716="" fontsize="17px"><!-- --><div class="my-article-component-container"><div><h2 id="video-explanation">Video Explanation</h2>
<div class="video-container" style="margin-top: 20px; position: relative; overflow: hidden">
<iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="" class="video" frameborder="0" src="https://www.youtube.com/embed/zx5Sw9130L0?rel=0" title="Vimeo video player">
</iframe>
</div></div><!-- --><!-- --><!-- --><!-- --><!-- --></div><!-- --><!-- --></app-article><a _ngcontent-ng-c3055955716="" href="https://www.youtube.com/watch?v=zx5Sw9130L0?rel=0" target="_blank"><br _ngcontent-ng-c3055955716=""/>View on Youtube<br _ngcontent-ng-c3055955716=""/></a><!-- --><br _ngcontent-ng-c3055955716=""/><app-article _ngcontent-ng-c3055955716="" fontsize="17px"><!-- --><div class="my-article-component-container"><div><h2 id="1-brute-force">1. Brute Force</h2>
<h3 id="intuition">Intuition</h3>
<p style="font-size: 17px">For every bar, we try to treat it as the <strong>shortest bar</strong> in the rectangle.<br/>To find how wide this rectangle can extend, we look <strong>left</strong> and <strong>right</strong> until we hit a bar shorter than the current one.<br/>The width between these two boundaries gives the largest rectangle where this bar is the limiting height.<br/>We repeat this for every bar and keep track of the maximum rectangle found.</p>
<h3 id="algorithm">Algorithm</h3>
<ol style="font-size: 17px">
<li>Let <code class="language-markdown" style="font-size: 14.5px">maxArea</code> store the largest rectangle found.</li>
<li>For each index <code class="language-markdown">i</code>:<ul style="font-size: 17px">
<li>Let <code class="language-markdown" style="font-size: 14.5px">height</code> be the height of the current bar.</li>
<li>Expand to the <strong>right</strong> until you find a bar shorter than <code class="language-markdown" style="font-size: 14.5px">height</code>.</li>
<li>Expand to the <strong>left</strong> while bars are not shorter than <code class="language-markdown" style="font-size: 14.5px">height</code>.</li>
<li>Compute the width between the boundaries.</li>
<li>Update <code class="language-markdown" style="font-size: 14.5px">maxArea</code> with <code class="language-markdown" style="font-size: 14.5px">height * width</code>.</li>
</ul>
</li>
<li>Return <code class="language-markdown" style="font-size: 14.5px">maxArea</code>.</li>
</ol>
</div><!-- --><!-- --><!-- --><!-- --><!-- --><app-code-tabs _nghost-ng-c3350875783=""><div _ngcontent-ng-c3350875783="" class="code-solution-tabs-container" style="margin-top: 2rem; margin-bottom: 2rem;"><div _ngcontent-ng-c3350875783="" class="tabs is-left" style="width: 100%; overflow-x: hidden; margin-bottom: 0px;"><ul _ngcontent-ng-c3350875783="" class="tabs-list" style="width: 100%; margin-left: 0px; margin-top: 0px; margin-bottom: 0px;"><li _ngcontent-ng-c3350875783="" class="tabs-list-item my-active-tab my-active-code-tab" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter bold-font" style="font-size: 16px;">Python</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">Java</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">C++</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">JavaScript</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">C#</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">Go</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">Kotlin</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">Swift</span></a></li><!-- --></ul></div><div _ngcontent-ng-c3350875783=""><app-code _ngcontent-ng-c3350875783=""><div class="outer-container" style="padding: 0;"><button class="copy-btn has-tooltip-left" data-tooltip="Copy"><fa-icon class="ng-fa-icon"><svg aria-hidden="true" class="svg-inline--fa fa-copy" data-icon="copy" data-prefix="fas" focusable="false" role="img" viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M208 0L332.1 0c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9L448 336c0 26.5-21.5 48-48 48l-192 0c-26.5 0-48-21.5-48-48l0-288c0-26.5 21.5-48 48-48zM48 128l80 0 0 64-64 0 0 256 192 0 0-32 64 0 0 48c0 26.5-21.5 48-48 48L48 512c-26.5 0-48-21.5-48-48L0 176c0-26.5 21.5-48 48-48z" fill="currentColor"></path></svg></fa-icon></button><pre class="language-python" style="padding: 0px; font-size: 17px;" tabindex="0"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Solution</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">largestRectangleArea</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> heights<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">int</span><span class="token punctuation">:</span>
        n <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>heights<span class="token punctuation">)</span>
        maxArea <span class="token operator">=</span> <span class="token number" style="font-size: 17px;">0</span>

        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
            height <span class="token operator">=</span> heights<span class="token punctuation">[</span>i<span class="token punctuation">]</span>

            rightMost <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number" style="font-size: 17px;">1</span>
            <span class="token keyword">while</span> rightMost <span class="token operator">&lt;</span> n <span class="token keyword">and</span> heights<span class="token punctuation">[</span>rightMost<span class="token punctuation">]</span> <span class="token operator">&gt;=</span> height<span class="token punctuation">:</span>
                rightMost <span class="token operator">+=</span> <span class="token number" style="font-size: 17px;">1</span>

            leftMost <span class="token operator">=</span> i
            <span class="token keyword">while</span> leftMost <span class="token operator">&gt;=</span> <span class="token number" style="font-size: 17px;">0</span> <span class="token keyword">and</span> heights<span class="token punctuation">[</span>leftMost<span class="token punctuation">]</span> <span class="token operator">&gt;=</span> height<span class="token punctuation">:</span>
                leftMost <span class="token operator">-=</span> <span class="token number" style="font-size: 17px;">1</span>

            rightMost <span class="token operator">-=</span> <span class="token number" style="font-size: 17px;">1</span>
            leftMost <span class="token operator">+=</span> <span class="token number" style="font-size: 17px;">1</span>
            maxArea <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>maxArea<span class="token punctuation">,</span> height <span class="token operator">*</span> <span class="token punctuation">(</span>rightMost <span class="token operator">-</span> leftMost <span class="token operator">+</span> <span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> maxArea</code></pre></div></app-code><!-- --></div><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --></div></app-code-tabs><!-- --><!-- --><!-- --><div><h3 id="time--space-complexity">Time &amp; Space Complexity</h3>
<ul style="font-size: 17px">
<li>Time complexity: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n ^ 2)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li>
<li>Space complexity: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li>
</ul>
<hr/>
<h2 id="2-divide-and-conquer-segment-tree">2. Divide And Conquer (Segment Tree)</h2>
<h3 id="intuition">Intuition</h3>
<p style="font-size: 17px">A large rectangle in the histogram must have some bar as its <strong>shortest bar</strong>.<br/>If we know the index of the <strong>minimum height bar</strong> in any range, then:</p>
<ul style="font-size: 17px">
<li>The largest rectangle that <strong>uses that bar as the limiting height</strong> spans the entire range.</li>
<li>Anything larger must lie <strong>entirely on the left</strong> or <strong>entirely on the right</strong> of that bar.</li>
</ul>
<p style="font-size: 17px">So we can solve the problem with a <strong>divide and conquer</strong> idea:</p>
<ol style="font-size: 17px">
<li>In a given range <code class="language-markdown" style="font-size: 14.5px">[L, R]</code>, find the index of the smallest bar.</li>
<li>Compute:<ul style="font-size: 17px">
<li>The area using this bar across the whole range.</li>
<li>The best area entirely in <code class="language-markdown" style="font-size: 14.5px">[L, minIndex - 1]</code>.</li>
<li>The best area entirely in <code class="language-markdown" style="font-size: 14.5px">[minIndex + 1, R]</code>.</li>
</ul>
</li>
<li>The answer for <code class="language-markdown" style="font-size: 14.5px">[L, R]</code> is the maximum of those three.</li>
</ol>
<p style="font-size: 17px">To find the <strong>index of the minimum height quickly</strong> for any range, we use a <strong>segment tree</strong> built on heights. It supports “min index in range” queries in <code class="language-markdown" style="font-size: 14.5px">O(log n)</code> time, which makes the whole divide-and-conquer efficient.</p>
<hr/>
<h3 id="algorithm">Algorithm</h3>
<ol style="font-size: 17px">
<li>Build a <strong>segment tree</strong> over the heights array:<ul style="font-size: 17px">
<li>Each node stores the index of the minimum height in its segment.</li>
</ul>
</li>
<li>Define a recursive function <code class="language-markdown">solve(L, R)</code>:<ul style="font-size: 17px">
<li>If <code class="language-markdown" style="font-size: 14.5px">L &gt; R</code>, return <code class="language-markdown" style="font-size: 14.5px">0</code>.</li>
<li>If <code class="language-markdown" style="font-size: 14.5px">L == R</code>, return <code class="language-markdown" style="font-size: 14.5px">heights[L]</code> (only one bar).</li>
<li>Use the segment tree to find <code class="language-markdown" style="font-size: 14.5px">minIndex</code> = index of the smallest bar in <code class="language-markdown" style="font-size: 14.5px">[L, R]</code>.</li>
<li>Compute:<ul style="font-size: 17px">
<li><code class="language-markdown" style="font-size: 14.5px">area_with_min = heights[minIndex] * (R - L + 1)</code></li>
<li><code class="language-markdown" style="font-size: 14.5px">area_left = solve(L, minIndex - 1)</code></li>
<li><code class="language-markdown" style="font-size: 14.5px">area_right = solve(minIndex + 1, R)</code></li>
</ul>
</li>
<li>Return <code class="language-markdown" style="font-size: 14.5px">max(area_with_min, area_left, area_right)</code>.</li>
</ul>
</li>
<li>The final answer is <code class="language-markdown" style="font-size: 14.5px">solve(0, n - 1)</code> where <code class="language-markdown" style="font-size: 14.5px">n</code> is the number of bars.</li>
</ol>
</div><!-- --><!-- --><!-- --><!-- --><!-- --><app-code-tabs _nghost-ng-c3350875783=""><div _ngcontent-ng-c3350875783="" class="code-solution-tabs-container" style="margin-top: 2rem; margin-bottom: 2rem;"><div _ngcontent-ng-c3350875783="" class="tabs is-left" style="width: 100%; overflow-x: hidden; margin-bottom: 0px;"><ul _ngcontent-ng-c3350875783="" class="tabs-list" style="width: 100%; margin-left: 0px; margin-top: 0px; margin-bottom: 0px;"><li _ngcontent-ng-c3350875783="" class="tabs-list-item my-active-tab my-active-code-tab" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter bold-font" style="font-size: 16px;">Python</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">Java</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">C++</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">JavaScript</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">C#</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">Go</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">Kotlin</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">Swift</span></a></li><!-- --></ul></div><div _ngcontent-ng-c3350875783=""><app-code _ngcontent-ng-c3350875783=""><div class="outer-container" style="padding: 0;"><button class="copy-btn has-tooltip-left" data-tooltip="Copy"><fa-icon class="ng-fa-icon"><svg aria-hidden="true" class="svg-inline--fa fa-copy" data-icon="copy" data-prefix="fas" focusable="false" role="img" viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M208 0L332.1 0c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9L448 336c0 26.5-21.5 48-48 48l-192 0c-26.5 0-48-21.5-48-48l0-288c0-26.5 21.5-48 48-48zM48 128l80 0 0 64-64 0 0 256 192 0 0-32 64 0 0 48c0 26.5-21.5 48-48 48L48 512c-26.5 0-48-21.5-48-48L0 176c0-26.5 21.5-48 48-48z" fill="currentColor"></path></svg></fa-icon></button><pre class="language-python" style="padding: 0px; font-size: 17px;" tabindex="0"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">MinIdx_Segtree</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> N<span class="token punctuation">,</span> A<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>n <span class="token operator">=</span> N
        self<span class="token punctuation">.</span>INF <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token number" style="font-size: 17px;">1e9</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>A <span class="token operator">=</span> A
        <span class="token keyword">while</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>n <span class="token operator">&amp;</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>n <span class="token operator">-</span> <span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number" style="font-size: 17px;">0</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>A<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>INF<span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>n <span class="token operator">+=</span> <span class="token number" style="font-size: 17px;">1</span>
        self<span class="token punctuation">.</span>tree <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number" style="font-size: 17px;">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number" style="font-size: 17px;">2</span> <span class="token operator">*</span> self<span class="token punctuation">.</span>n<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>build<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">build</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>tree<span class="token punctuation">[</span>self<span class="token punctuation">.</span>n <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> i
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>n <span class="token operator">-</span> <span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">,</span> <span class="token number" style="font-size: 17px;">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            a <span class="token operator">=</span> self<span class="token punctuation">.</span>tree<span class="token punctuation">[</span>j <span class="token operator">&lt;&lt;</span> <span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">]</span>
            b <span class="token operator">=</span> self<span class="token punctuation">.</span>tree<span class="token punctuation">[</span><span class="token punctuation">(</span>j <span class="token operator">&lt;&lt;</span> <span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">]</span>
            <span class="token keyword">if</span> self<span class="token punctuation">.</span>A<span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> self<span class="token punctuation">.</span>A<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>tree<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> a
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>tree<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> b

    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> i<span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>A<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> val
        j <span class="token operator">=</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>n <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number" style="font-size: 17px;">1</span>
        <span class="token keyword">while</span> j <span class="token operator">&gt;=</span> <span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">:</span>
            a <span class="token operator">=</span> self<span class="token punctuation">.</span>tree<span class="token punctuation">[</span>j <span class="token operator">&lt;&lt;</span> <span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">]</span>
            b <span class="token operator">=</span> self<span class="token punctuation">.</span>tree<span class="token punctuation">[</span><span class="token punctuation">(</span>j <span class="token operator">&lt;&lt;</span> <span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">]</span>
            <span class="token keyword">if</span> self<span class="token punctuation">.</span>A<span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> self<span class="token punctuation">.</span>A<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>tree<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> a
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>tree<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> b
            j <span class="token operator">&gt;&gt;</span><span class="token operator">=</span> <span class="token number" style="font-size: 17px;">1</span>

    <span class="token keyword">def</span> <span class="token function">query</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> ql<span class="token punctuation">,</span> qh<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_query<span class="token punctuation">(</span><span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">,</span> <span class="token number" style="font-size: 17px;">0</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>n <span class="token operator">-</span> <span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">,</span> ql<span class="token punctuation">,</span> qh<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">_query</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> node<span class="token punctuation">,</span> l<span class="token punctuation">,</span> h<span class="token punctuation">,</span> ql<span class="token punctuation">,</span> qh<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> ql <span class="token operator">&gt;</span> h <span class="token keyword">or</span> qh <span class="token operator">&lt;</span> l<span class="token punctuation">:</span>
            <span class="token keyword">return</span> self<span class="token punctuation">.</span>INF
        <span class="token keyword">if</span> l <span class="token operator">&gt;=</span> ql <span class="token keyword">and</span> h <span class="token operator">&lt;=</span> qh<span class="token punctuation">:</span>
            <span class="token keyword">return</span> self<span class="token punctuation">.</span>tree<span class="token punctuation">[</span>node<span class="token punctuation">]</span>
        a <span class="token operator">=</span> self<span class="token punctuation">.</span>_query<span class="token punctuation">(</span>node <span class="token operator">&lt;&lt;</span> <span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">,</span> l<span class="token punctuation">,</span> <span class="token punctuation">(</span>l <span class="token operator">+</span> h<span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">,</span> ql<span class="token punctuation">,</span> qh<span class="token punctuation">)</span>
        b <span class="token operator">=</span> self<span class="token punctuation">.</span>_query<span class="token punctuation">(</span><span class="token punctuation">(</span>node <span class="token operator">&lt;&lt;</span> <span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>l <span class="token operator">+</span> h<span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">,</span> h<span class="token punctuation">,</span> ql<span class="token punctuation">,</span> qh<span class="token punctuation">)</span>
        <span class="token keyword">if</span> a <span class="token operator">==</span> self<span class="token punctuation">.</span>INF<span class="token punctuation">:</span>
            <span class="token keyword">return</span> b
        <span class="token keyword">if</span> b <span class="token operator">==</span> self<span class="token punctuation">.</span>INF<span class="token punctuation">:</span>
            <span class="token keyword">return</span> a
        <span class="token keyword">return</span> a <span class="token keyword">if</span> self<span class="token punctuation">.</span>A<span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> self<span class="token punctuation">.</span>A<span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token keyword">else</span> b

<span class="token keyword">class</span> <span class="token class-name">Solution</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">getMaxArea</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> heights<span class="token punctuation">,</span> l<span class="token punctuation">,</span> r<span class="token punctuation">,</span> st<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> l <span class="token operator">&gt;</span> r<span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token number" style="font-size: 17px;">0</span>
        <span class="token keyword">if</span> l <span class="token operator">==</span> r<span class="token punctuation">:</span>
            <span class="token keyword">return</span> heights<span class="token punctuation">[</span>l<span class="token punctuation">]</span>
        minIdx <span class="token operator">=</span> st<span class="token punctuation">.</span>query<span class="token punctuation">(</span>l<span class="token punctuation">,</span> r<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token builtin">max</span><span class="token punctuation">(</span><span class="token builtin">max</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>getMaxArea<span class="token punctuation">(</span>heights<span class="token punctuation">,</span> l<span class="token punctuation">,</span> minIdx <span class="token operator">-</span> <span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">,</span> st<span class="token punctuation">)</span><span class="token punctuation">,</span>
                       self<span class="token punctuation">.</span>getMaxArea<span class="token punctuation">(</span>heights<span class="token punctuation">,</span> minIdx <span class="token operator">+</span> <span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">,</span> r<span class="token punctuation">,</span> st<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                   <span class="token punctuation">(</span>r <span class="token operator">-</span> l <span class="token operator">+</span> <span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> heights<span class="token punctuation">[</span>minIdx<span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">largestRectangleArea</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> heights<span class="token punctuation">)</span><span class="token punctuation">:</span>
        n <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>heights<span class="token punctuation">)</span>
        st <span class="token operator">=</span> MinIdx_Segtree<span class="token punctuation">(</span>n<span class="token punctuation">,</span> heights<span class="token punctuation">)</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>getMaxArea<span class="token punctuation">(</span>heights<span class="token punctuation">,</span> <span class="token number" style="font-size: 17px;">0</span><span class="token punctuation">,</span> n <span class="token operator">-</span> <span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">,</span> st<span class="token punctuation">)</span></code></pre></div></app-code><!-- --></div><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --></div></app-code-tabs><!-- --><!-- --><!-- --><div><h3 id="time--space-complexity">Time &amp; Space Complexity</h3>
<ul style="font-size: 17px">
<li>Time complexity: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n \log n)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></li>
<li>Space complexity: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></li>
</ul>
<hr/>
<h2 id="3-stack">3. Stack</h2>
<h3 id="intuition">Intuition</h3>
<p style="font-size: 17px">For each bar, we want to know how far it can stretch left and right <strong>before bumping into a shorter bar</strong>.<br/>That distance tells us the widest rectangle where this bar is the limiting height.<br/>To efficiently find the nearest smaller bar on both sides, we use a <strong>monotonic stack</strong> that keeps indices of bars in increasing height order.<br/>This lets us compute boundaries in linear time instead of checking outward for every bar.</p>
<h3 id="algorithm">Algorithm</h3>
<ol style="font-size: 17px">
<li>Use a stack to find, for each index <code class="language-markdown">i</code>, the nearest smaller bar on the <strong>left</strong>:<ul style="font-size: 17px">
<li>If the current bar is shorter than the bar on top of the stack, pop until this is no longer true.</li>
<li>The top of the stack becomes the left boundary.</li>
<li>If the stack is empty, no smaller bar exists → left boundary is <code class="language-markdown" style="font-size: 14.5px">-1</code>.</li>
</ul>
</li>
<li>Repeat the same process from right to left to find the nearest smaller bar on the <strong>right</strong>:<ul style="font-size: 17px">
<li>If no smaller bar exists, the right boundary is <code class="language-markdown" style="font-size: 14.5px">n</code>.</li>
</ul>
</li>
<li>For each bar:<ul style="font-size: 17px">
<li>Expand between the boundaries and compute its max rectangle:<br/><code class="language-markdown" style="font-size: 14.5px">height[i] * (right - left - 1)</code></li>
</ul>
</li>
<li>Return the largest area found.</li>
</ol>
</div><!-- --><!-- --><!-- --><!-- --><!-- --><app-code-tabs _nghost-ng-c3350875783=""><div _ngcontent-ng-c3350875783="" class="code-solution-tabs-container" style="margin-top: 2rem; margin-bottom: 2rem;"><div _ngcontent-ng-c3350875783="" class="tabs is-left" style="width: 100%; overflow-x: hidden; margin-bottom: 0px;"><ul _ngcontent-ng-c3350875783="" class="tabs-list" style="width: 100%; margin-left: 0px; margin-top: 0px; margin-bottom: 0px;"><li _ngcontent-ng-c3350875783="" class="tabs-list-item my-active-tab my-active-code-tab" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter bold-font" style="font-size: 16px;">Python</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">Java</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">C++</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">JavaScript</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">C#</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">Go</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">Kotlin</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">Swift</span></a></li><!-- --></ul></div><div _ngcontent-ng-c3350875783=""><app-code _ngcontent-ng-c3350875783=""><div class="outer-container" style="padding: 0;"><button class="copy-btn has-tooltip-left" data-tooltip="Copy"><fa-icon class="ng-fa-icon"><svg aria-hidden="true" class="svg-inline--fa fa-copy" data-icon="copy" data-prefix="fas" focusable="false" role="img" viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M208 0L332.1 0c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9L448 336c0 26.5-21.5 48-48 48l-192 0c-26.5 0-48-21.5-48-48l0-288c0-26.5 21.5-48 48-48zM48 128l80 0 0 64-64 0 0 256 192 0 0-32 64 0 0 48c0 26.5-21.5 48-48 48L48 512c-26.5 0-48-21.5-48-48L0 176c0-26.5 21.5-48 48-48z" fill="currentColor"></path></svg></fa-icon></button><pre class="language-python" style="padding: 0px; font-size: 17px;" tabindex="0"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Solution</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">largestRectangleArea</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> heights<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">int</span><span class="token punctuation">:</span>
        n <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>heights<span class="token punctuation">)</span>
        stack <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

        leftMost <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> n
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">while</span> stack <span class="token keyword">and</span> heights<span class="token punctuation">[</span>stack<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&gt;=</span> heights<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>
                stack<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> stack<span class="token punctuation">:</span>
                leftMost<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> stack<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">]</span>
            stack<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>

        stack <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        rightMost <span class="token operator">=</span> <span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">*</span> n
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">while</span> stack <span class="token keyword">and</span> heights<span class="token punctuation">[</span>stack<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&gt;=</span> heights<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>
                stack<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> stack<span class="token punctuation">:</span>
                rightMost<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> stack<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">]</span>
            stack<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>

        maxArea <span class="token operator">=</span> <span class="token number" style="font-size: 17px;">0</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
            leftMost<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number" style="font-size: 17px;">1</span>
            rightMost<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number" style="font-size: 17px;">1</span>
            maxArea <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>maxArea<span class="token punctuation">,</span> heights<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span>rightMost<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> leftMost<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> maxArea</code></pre></div></app-code><!-- --></div><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --></div></app-code-tabs><!-- --><!-- --><!-- --><div><h3 id="time--space-complexity">Time &amp; Space Complexity</h3>
<ul style="font-size: 17px">
<li>Time complexity: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></li>
<li>Space complexity: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></li>
</ul>
<hr/>
<h2 id="4-stack-one-pass">4. Stack (One Pass)</h2>
<h3 id="intuition">Intuition</h3>
<p style="font-size: 17px">We want, for each bar, the widest area where it can act as the <strong>shortest bar</strong>.<br/>With a single pass and a stack, we can do this on the fly:</p>
<ul style="font-size: 17px">
<li>We keep a stack of bars in <strong>increasing height order</strong>, each stored with the earliest index where that height can start.</li>
<li>When we see a new bar that is <strong>shorter</strong> than the top of the stack, it means the taller bar on top can’t extend further to the right.<ul style="font-size: 17px">
<li>So we pop it and compute the area it could cover.</li>
</ul>
</li>
<li>The new shorter bar can start from as far left as the popped bar’s start index, so we reuse that index.</li>
<li>After the pass, we compute areas for any bars still in the stack, extending them to the end.</li>
</ul>
<p style="font-size: 17px">Each bar is pushed and popped at most once, giving an efficient, one-pass solution.</p>
<h3 id="algorithm">Algorithm</h3>
<ol style="font-size: 17px">
<li>Initialize:<ul style="font-size: 17px">
<li>an empty stack to store pairs <code class="language-markdown" style="font-size: 14.5px">(start_index, height)</code>,</li>
<li><code class="language-markdown" style="font-size: 14.5px">maxArea = 0</code>.</li>
</ul>
</li>
<li>Traverse the histogram from left to right with index <code class="language-markdown">i</code> and height <code class="language-markdown">h</code>:<ul style="font-size: 17px">
<li>Set <code class="language-markdown" style="font-size: 14.5px">start = i</code>.</li>
<li>While the stack is not empty and the top height is <strong>greater than</strong> <code class="language-markdown">h</code>:<ul style="font-size: 17px">
<li>Pop <code class="language-markdown" style="font-size: 14.5px">(index, height)</code> from the stack.</li>
<li>Update <code class="language-markdown" style="font-size: 14.5px">maxArea</code> with <code class="language-markdown" style="font-size: 14.5px">height * (i - index)</code>.</li>
<li>Set <code class="language-markdown" style="font-size: 14.5px">start = index</code> (the new bar can start from here).</li>
</ul>
</li>
<li>Push <code class="language-markdown" style="font-size: 14.5px">(start, h)</code> onto the stack.</li>
</ul>
</li>
<li>After the loop, process remaining bars in the stack:<ul style="font-size: 17px">
<li>For each <code class="language-markdown">(index, height)</code> in the stack:<ul style="font-size: 17px">
<li>Update <code class="language-markdown" style="font-size: 14.5px">maxArea</code> with <code class="language-markdown" style="font-size: 14.5px">height * (n - index)</code>, where <code class="language-markdown" style="font-size: 14.5px">n</code> is the total number of bars.</li>
</ul>
</li>
</ul>
</li>
<li>Return <code class="language-markdown" style="font-size: 14.5px">maxArea</code>.</li>
</ol>
</div><!-- --><!-- --><!-- --><!-- --><!-- --><app-code-tabs _nghost-ng-c3350875783=""><div _ngcontent-ng-c3350875783="" class="code-solution-tabs-container" style="margin-top: 2rem; margin-bottom: 2rem;"><div _ngcontent-ng-c3350875783="" class="tabs is-left" style="width: 100%; overflow-x: hidden; margin-bottom: 0px;"><ul _ngcontent-ng-c3350875783="" class="tabs-list" style="width: 100%; margin-left: 0px; margin-top: 0px; margin-bottom: 0px;"><li _ngcontent-ng-c3350875783="" class="tabs-list-item my-active-tab my-active-code-tab" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter bold-font" style="font-size: 16px;">Python</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">Java</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">C++</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">JavaScript</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">C#</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">Go</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">Kotlin</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">Swift</span></a></li><!-- --></ul></div><div _ngcontent-ng-c3350875783=""><app-code _ngcontent-ng-c3350875783=""><div class="outer-container" style="padding: 0;"><button class="copy-btn has-tooltip-left" data-tooltip="Copy"><fa-icon class="ng-fa-icon"><svg aria-hidden="true" class="svg-inline--fa fa-copy" data-icon="copy" data-prefix="fas" focusable="false" role="img" viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M208 0L332.1 0c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9L448 336c0 26.5-21.5 48-48 48l-192 0c-26.5 0-48-21.5-48-48l0-288c0-26.5 21.5-48 48-48zM48 128l80 0 0 64-64 0 0 256 192 0 0-32 64 0 0 48c0 26.5-21.5 48-48 48L48 512c-26.5 0-48-21.5-48-48L0 176c0-26.5 21.5-48 48-48z" fill="currentColor"></path></svg></fa-icon></button><pre class="language-python" style="padding: 0px; font-size: 17px;" tabindex="0"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Solution</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">largestRectangleArea</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> heights<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">int</span><span class="token punctuation">:</span>
        maxArea <span class="token operator">=</span> <span class="token number" style="font-size: 17px;">0</span>
        stack <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment"># pair: (index, height)</span>

        <span class="token keyword">for</span> i<span class="token punctuation">,</span> h <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>heights<span class="token punctuation">)</span><span class="token punctuation">:</span>
            start <span class="token operator">=</span> i
            <span class="token keyword">while</span> stack <span class="token keyword">and</span> stack<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> h<span class="token punctuation">:</span>
                index<span class="token punctuation">,</span> height <span class="token operator">=</span> stack<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span>
                maxArea <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>maxArea<span class="token punctuation">,</span> height <span class="token operator">*</span> <span class="token punctuation">(</span>i <span class="token operator">-</span> index<span class="token punctuation">)</span><span class="token punctuation">)</span>
                start <span class="token operator">=</span> index
            stack<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> h<span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token keyword">for</span> i<span class="token punctuation">,</span> h <span class="token keyword">in</span> stack<span class="token punctuation">:</span>
            maxArea <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>maxArea<span class="token punctuation">,</span> h <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>heights<span class="token punctuation">)</span> <span class="token operator">-</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> maxArea</code></pre></div></app-code><!-- --></div><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --></div></app-code-tabs><!-- --><!-- --><!-- --><div><h3 id="time--space-complexity">Time &amp; Space Complexity</h3>
<ul style="font-size: 17px">
<li>Time complexity: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></li>
<li>Space complexity: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></li>
</ul>
<hr/>
<h2 id="5-stack-optimal">5. Stack (Optimal)</h2>
<h3 id="intuition">Intuition</h3>
<p style="font-size: 17px">We want, for every bar, to know how wide it can stretch while still being the <strong>shortest bar</strong> in that rectangle.</p>
<p style="font-size: 17px">A monotonic stack helps with this:</p>
<ul style="font-size: 17px">
<li>We keep a stack of indices where the bar heights are in <strong>increasing order</strong>.</li>
<li>As long as the next bar is <strong>taller or equal</strong>, we keep pushing indices.</li>
<li>When we see a <strong>shorter</strong> bar, it means the bar on top of the stack can’t extend further to the right:<ul style="font-size: 17px">
<li>We pop it and treat it as the height of a rectangle.</li>
<li>Its width goes from the new top of the stack + 1 up to the current index − 1.</li>
</ul>
</li>
</ul>
<p style="font-size: 17px">To make sure every bar eventually gets popped and processed, we run the loop one extra step with a “virtual” bar of height 0 at the end.<br/>Each bar is pushed and popped at most once, so this is both optimal and clean.</p>
<h3 id="algorithm">Algorithm</h3>
<ol style="font-size: 17px">
<li>Initialize:<ul style="font-size: 17px">
<li><code class="language-markdown" style="font-size: 14.5px">maxArea = 0</code></li>
<li>an empty stack to store indices of bars (with heights in increasing order).</li>
</ul>
</li>
<li>Loop <code class="language-markdown">i</code> from <code class="language-markdown">0</code> to <code class="language-markdown">n</code> (inclusive):<ul style="font-size: 17px">
<li>While the stack is not empty <strong>and</strong> either:<ul style="font-size: 17px">
<li><code class="language-markdown" style="font-size: 14.5px">i == n</code> (we’re past the last bar, acting like height 0), or</li>
<li><code class="language-markdown">heights[i]</code> is <strong>less than or equal</strong> to the height at the top index of the stack:<ul style="font-size: 17px">
<li>Pop the top index; let its height be <code class="language-markdown" style="font-size: 14.5px">h</code>.</li>
<li>Compute the width:<ul style="font-size: 17px">
<li>If the stack is empty, width = <code class="language-markdown" style="font-size: 14.5px">i</code> (it extends from 0 to <code class="language-markdown" style="font-size: 14.5px">i - 1</code>).</li>
<li>Otherwise, width = <code class="language-markdown" style="font-size: 14.5px">i - stack.top() - 1</code>.</li>
</ul>
</li>
<li>Update <code class="language-markdown" style="font-size: 14.5px">maxArea</code> with <code class="language-markdown" style="font-size: 14.5px">h * width</code>.</li>
</ul>
</li>
</ul>
</li>
<li>Push the current index <code class="language-markdown" style="font-size: 14.5px">i</code> onto the stack.</li>
</ul>
</li>
<li>After the loop, <code class="language-markdown" style="font-size: 14.5px">maxArea</code> holds the largest rectangle area. Return it.</li>
</ol>
</div><!-- --><!-- --><!-- --><!-- --><!-- --><app-code-tabs _nghost-ng-c3350875783=""><div _ngcontent-ng-c3350875783="" class="code-solution-tabs-container" style="margin-top: 2rem; margin-bottom: 2rem;"><div _ngcontent-ng-c3350875783="" class="tabs is-left" style="width: 100%; overflow-x: hidden; margin-bottom: 0px;"><ul _ngcontent-ng-c3350875783="" class="tabs-list" style="width: 100%; margin-left: 0px; margin-top: 0px; margin-bottom: 0px;"><li _ngcontent-ng-c3350875783="" class="tabs-list-item my-active-tab my-active-code-tab" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter bold-font" style="font-size: 16px;">Python</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">Java</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">C++</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">JavaScript</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">C#</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">Go</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">Kotlin</span></a></li><li _ngcontent-ng-c3350875783="" class="tabs-list-item" style="margin: 0px;"><a _ngcontent-ng-c3350875783="" role="button" tabindex="0"><span _ngcontent-ng-c3350875783="" class="tab-header font-inter light-text" style="font-size: 16px;">Swift</span></a></li><!-- --></ul></div><div _ngcontent-ng-c3350875783=""><app-code _ngcontent-ng-c3350875783=""><div class="outer-container" style="padding: 0;"><button class="copy-btn has-tooltip-left" data-tooltip="Copy"><fa-icon class="ng-fa-icon"><svg aria-hidden="true" class="svg-inline--fa fa-copy" data-icon="copy" data-prefix="fas" focusable="false" role="img" viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M208 0L332.1 0c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9L448 336c0 26.5-21.5 48-48 48l-192 0c-26.5 0-48-21.5-48-48l0-288c0-26.5 21.5-48 48-48zM48 128l80 0 0 64-64 0 0 256 192 0 0-32 64 0 0 48c0 26.5-21.5 48-48 48L48 512c-26.5 0-48-21.5-48-48L0 176c0-26.5 21.5-48 48-48z" fill="currentColor"></path></svg></fa-icon></button><pre class="language-python" style="padding: 0px; font-size: 17px;" tabindex="0"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Solution</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">largestRectangleArea</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> heights<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">int</span><span class="token punctuation">:</span>
        n <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>heights<span class="token punctuation">)</span>
        maxArea <span class="token operator">=</span> <span class="token number" style="font-size: 17px;">0</span>
        stack <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">while</span> stack <span class="token keyword">and</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> n  <span class="token keyword">or</span> heights<span class="token punctuation">[</span>stack<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&gt;=</span> heights<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                height <span class="token operator">=</span> heights<span class="token punctuation">[</span>stack<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
                width <span class="token operator">=</span> i <span class="token keyword">if</span> <span class="token keyword">not</span> stack <span class="token keyword">else</span> i <span class="token operator">-</span> stack<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number" style="font-size: 17px;">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number" style="font-size: 17px;">1</span>
                maxArea <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>maxArea<span class="token punctuation">,</span> height <span class="token operator">*</span> width<span class="token punctuation">)</span>
            stack<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
        <span class="token keyword">return</span> maxArea</code></pre></div></app-code><!-- --></div><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --><!-- --></div></app-code-tabs><!-- --><!-- --><!-- --><div><h3 id="time--space-complexity">Time &amp; Space Complexity</h3>
<ul style="font-size: 17px">
<li>Time complexity: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></li>
<li>Space complexity: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></li>
</ul>
</div><!-- --><!-- --><!-- --><!-- --><!-- --></div><!-- --><!-- --></app-article><!-- --><!-- --></div>